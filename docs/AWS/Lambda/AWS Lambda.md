***
## 1. AWS Lambda 개요

- 서버를 프로저닝하거나 관리할 필요없ㅣ 코드를 실행할 수 있다.
- 서버리스 애플리케이션이라고 생각
- 고가용성 컴퓨팅 인프라에서 코드를 실행하고, 서버와 운영체제 유지 관리, 용량 프로비저닝 및 자동 조정, 코드 및 보안 패치 배포, 로깅 등, 모든 컴퓨팅 리소스 관리를 수행
- 코드만 제공하면 된다. 단, 사용한 컴퓨팅 시간만큼만 비용을 지불하면 된다.
***
## 2. Lambda 사용하는 경우

- 빠르게 스케일 업하고, 수요가 없을 때 0으로 스케일 다운하는 애플리케이션 시나리오에 이상적인 컴퓨팅 서비스
- 사용 예시 상황)
	- S3 를 사용하여 Lambda 데이터 처리를 실시간으로 트리거
	- Amazon Kinesis를 사용하여 앱 작업 추적, 거래 주문 처리, 데이터 정리, 등 실시간 스트리밍 데이터를 처리
	- 다른 AWS 서비스와 결합하여 여러 데이터 센터에서 고가용성 구성으로 자동으로 스케일 업/스케일 다운 실행되는 웹 애플리케이션 빌드
	- 서버리스 백엔드를 구축함으로써, IoT 및 서드 파티 API 요청 처리
	- Amazon API gateway를 사용하여 백엔드 구축함으로써 API요청을 인증하고 처리

***
## 3. 주요 용어

- 서버리스 이벤트 기반 컴퓨팅 서비스이므로, 기존 웹 애플리케이션과 다른 프로그래밍 패러다임을 사용
- Lambda 함수 : 애플리케이션을 빌드하는 데 사용하는 Lambda의 기본 구성 요소'
	- 사용자가 웹 사이트에서 버튼을 클릭하거나 S3 버킷에 파일을 업로드하는 것과 같은 이벤트에 대한 응답으로 실행되는 코드.
	- 일종의 독립적인 프로그램이라고 생각할 수 있다.
		- 함수에는 하나의 특정 작업 또는 목적이 있다.
		- 특정 이벤트에 대한 응답으로 필요할 때만 실행
		- 완료되면 자동으로 실행을 중지
	- 함수가 실행되면 Lambda는 함수의 핸들러 함수를 실행
	- 함수를 실행한 이벤트에 대한 데이터가 이 핸들러에 직접 전달
	- Lambda함수의 코드에는 둘 이상의 메서드나 함수를 포함할 수 있지만, Lambda 함수에는 Handler가 하나만 있을 수 있다.
- Lambda 런타임 : 함수가 실행되는 언어별 환경
	- 안전하고 격리된 실행 환경 내에서 실행. 이 안에서 필요한 프로세스와 리소스를 관리
	- 언어별로 여러 런타임 환경을 제공
- 트리거 및 이벤트 소스 매핑 : 특정 이벤트가 실시될 때 그 이벤트에 대한 응답으로 다른 AWS 서비스에서 함수를 간접적으로 호출하는 방법
	- 일반적으로 API를 통한 호출 보다 트리거를 통한 Lambda 함수의 호출을 이용
	- 특정 트리거를  기반으로 람다함수를 간접 한다.
	- 예시)
		![[AWS Lambda-20250203154423375.webp|468]]
	- S3 버킷에 대한 트리거를 구성
	- S3 버킷에 객체를 추가할 때마다 함수가 실행되고 Amazon CloudWatch Logs 에 객체 유형을 출력
- 이벤트 객체 : 함수가 처리할 이벤트 데이터가 포함된 JSON 객체
- Lambda 권한 : 함수가 상호 작용할 수 있는 다른 AWS 서비스와 함수에 액세스할 수 있는 사용자를 제어하는 방법

***
## 4. 이벤트 및 이벤트 기반 아키텍처

- 폴링 및 웹후크를 이벤트로 대체
	- 폴링 및 웹후크
		- 폴링은 데이터요청이 있는지 지속적으로 응답을 보내는 과정을 의미하고 웹 후크는 이벤트가 있다는 것을 서버에서 클라이언트로 전송하는 방식이다. 이 두 방식 모두 Downstream 서비스와의 동기화 사이에 지연이 있기 때문에 업데이트를 가져오는 데 매우 비효율적일 수 있다.
		- 
	- 이 두 메커니즘을 이벤트로 대체될 수 있으면서, 이 접근 방식을 사용하여 CPU 사용률, 잠재적 비용이 감소할 수 있다.
***
## 5. Lambda 기반 App의 좋지 않은 패턴

- Lambda 모놀리스
	- 기존 서버, EC2 인스턴스에서 오는 많은 API Gateway를 모두 단일 Lambda 함수가 애플리케이션을 수행하게하는 방식이다. 
	- Lambda함수의 패키지가 매우 크다. 
	- 권한 부여 문제로 인해, 보안에 문제가 될 수있다.
	- 유지관리가 어렵다. 코드 리포지토리이기 때문
		![[AWS Lambda-20250206151053446.webp|530]]
- 재귀 패턴
	- 람다함수에 의해 다른 이벤트가 호출되고, 이 이벤트로 인해 또 다른 람다함수가 호출되는 패턴
	- 재귀적으로 계속 호출하여 무한루프가 발생될 수 있기 때문에 피해야 한다.]]![[AWS Lambda-20250206151358511.webp|549]]
- 단일 람다 함수 내에서 동기식 대기
	- 단일 람다 함수에서 동기식으로 예약되어 다른 응답을 기다리게 하는 패턴은 좋지 않다.
	- 순차적 활동으로 인해 대기시간이 복잡해 진다. 대기 시간 및 실행시간이 늘어나고 비용을 발생 시킬 수있다.![[AWS Lambda-20250206151616696.webp]]
	- 위 경우는 프로젝트 당시 직접 설계한 방식
	- Lambda 함수가 DB 에 데이터를 조회하고, 데이터가 없으면 S3 bucket의 파일을 제거하는 동작을 하게끔 설계하였다. 
	- 이 경우 DB 조회 이후 S3 데이터 삭제가 동기식으로 일어나게 되어 좋지 않은 설계가 된다.
	- 람다함수의 시간 제한(최대 15분)
	- 해결 방법
		- 람다 함수를 쪼개어서 하나에 하나의 데이터를 접근하도록 설계한다.![[AWS Lambda-20250206155716880.webp]]
		- 비용적 측면을 고려해 비동기식으로 바꿀 수 있다.
